---
title: "Individual Variation in Animal Movement and Effects on Seed Dispersal Distance"
abstract: |
  I don't like this abstract. Revisit at the end...Seed dispersal is a fundamental process in plant ecology and due to its high importance in the ecosystem, various modelling approaches have been developed to understand seed movement and dispersal mechanisms. In particular, long-distance seed dispersal (LDD) plays a significant role in determining a population's genetic diversity and range expansion. Animal-mediated seed dispersal is a key component of LDD events, as frugivores can travel long distances and transport seeds with them. In this study we seek to understand the implications of individual variation in animal movement and how these can impact estimates of long distance seed dispersal. We apply these methods to empirical data sets that contain locations for an araçari, *Pteroglossus pluricintus*, one of the primary frugivores for the Amazonian canopy tree *Virola flexuosa*. We combine animal movement data and gut retention time to simulate *Virola* seed dispersal. This approach showed that there is significant variation in individual araçari movement patterns which directly influence the estimated number of long-distance dispersal events for *Virola* seeds. We found that models that ignore this underlying variation in individual animal movement, underestimate the percentage of long-distance seed dispersal events and maximum seed dispersal distances.
output:
  html_document:
    df_print: paged
  word_document:
    reference_docx: paper_ref.docx
bibliography: mybibfile.bib
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r libraries}
library(ggplot2)
library(aracari)
library(cowplot)
library(dplyr)

```

\newpage
# Introduction
A main goal of ecologists and evolutionary biologists is to document and predict the structure and dynamics of ecological systems. Although most of our current understanding of ecological systems is based on the average patterns observed in nature, understanding variability and its consequences in ecological processes has recently raised the interests of researchers [@benedetti-cecchi_importance_2003; @inouye_importance_2005]. Variation is now considered a property of ecological systems that might contain as much ecological information as do averages and regularities in nature [@benedetti-cecchi_importance_2003; @violle_return_2012].
Individual variation, i.e. the possibility for individuals within a population to present different ecological strategies or traits [@violle_return_2012], has been widely discussed in ecology and evolutionary biology. In evolutionary biology the acknowledgement that individuals with different traits might vary in their fitness and survival under natural selection pressures dates back to Darwin’s seminal ideas [@darwin_origin_1859]. Today, it is widely recognized that individual variation plays a key role in the evolution of species and clades, and the relevance of individual variation in the performance of populations and species facing current threats (e.g. climate change, fragmentation and habitat loss) is a growing field of research [@forsman_inter-individual_2016]. In ecology, individual variation is often mentioned as a mechanism for populations to reduce competition pressure [@bolnick_ecological_2010; @araujo_ecological_2011]. Based on the niche complementarity principle, phenotypically different individuals will compete less strongly than more similar individuals [@bolnick_why_2011], thus individual variation would act as a release from intra- and interspecific competition at a local scale. Despite the well recognized importance of individual variation in ecological and evolutionary processes, ecological theory has emphasized interspecific variation [@violle_return_2012]. Not surprisingly, the role of individual variability on the outcome of species interactions has also been poorly studied; most models of species interactions assume that all conspecific individuals are equivalent and interchangeable [@bolnick_why_2011]. Individuals, however, differ in several aspects that will affect their interactions with other species. This variability makes individuals non-interchangeable from the perspective of interacting patterns [@bolnick_ecology_2003; @gonzalez-varo_labile_2016]. The consequences of individual variability in interspecies interactions can even have cascading effects, going beyond from the species-species level to the community and ecosystem level [@post_intraspecific_2008; @wolf_animal_2012].

Seed dispersal mutualisms may be a particularly attractive system to study the impacts of incorporating individual variation to understanding the importance of such variation to dispersal outcomes. Seed dispersal is one of the most critical stages in plant life history – it results in a spatial pattern of seed deposition which acts as a template that will define the distribution of plants and, consequently, community structure [@howe1982ecology; @nathan_spatial_2000; @russo_incorporating_2006]. In seed dispersal mutualisms, animals provide the dispersal services while rewarding from fruit resources they consume. Plants produce fleshy fruits to attract and reward mutualist animals and rely on the behavior of the disperser to transport their propagules [@nathan_spatial_2000]. The spatial patterns of seed deposited by disperser vectors will determine the probability of seed survival and recruitment, acting upon post-dispersal processes such as density-dependent survival and colonization [@howe2004seed]. Therefore, at a local scale, seed dispersers will determine whether plant species escape from density-dependence processes [@comita2014testing], whereas at a larger scale, they can determine how quickly plants can cope with habitat and climate shifts [@ibanez2006predicting; @russo_incorporating_2006].  

From the plant perspective, not all seed dispersers species provide with the same seed dispersal service, and often relatively few disperser species can have disproportionate effects on seed dispersal [@schupp1993quantity; @jordano2007differential; @schupp_seed_2010; @loayza2014seed]. Frugivores might differ on their selection of plants/fruits for consumption, in their treatment of seed while ingesting and manipulating the fruits, in their processing of seeds if ingested and in the distance where they will discard the seeds [@schupp1993quantity; @schupp_seed_2010; @cortes_integrating_2013]. Each one of these stages of the seed dispersal process will have strong consequences on the spatial seed shadow provided by each seed dispersal vector [@jordano2007differential; @carlo2014directness]. Besides inter-specific differences among dispersal vectors, there is a recent recognition of the potential role of differences among individuals in the resulting seed dispersal they provide [@bolnick_ecology_2003; @gonzalez-varo_labile_2016]. Including individual variation in traits (morphological, behavioral and physiological) in seed dispersal studies, can provide new insights into the relative role of different dispersal vectors on seed deposition and ultimately, vegetation structure [@gonzalez-varo_labile_2016]. In a recent review, Zwolak [@zwolak_how_2018] summarized the types of intraspecific variation in seed-dispersing animals that might affect the resulting seed dispersal service individuals provide, highlighting differences in sex, size or age (ontogenetic shifts), individual specialization and behavioral syndromes as the most important variation types. Incorporating these intrinsic traits into seed dispersal models may lead to more mechanistic understanding of seed dispersal, allow to build more accurate predictive frameworks of dispersal outcomes [@russo_incorporating_2006] and to identify links between characteristics of dispersal agents and the seed dispersal they provide [@zwolak_how_2018]. 

In this paper, we focus on the implications of intraspecific variation in animal movement for seed dispersal distances and seed aggregation across the landscape. To understand the consequences of this variation in movement, we developed a spatially-explicit individual-based model of the many-banded aracari, *Pteroglossus pluricinctus*, one of the primary frugivores of the Amazonian canopy tree *Virola flexuosa*. Also, previous studies focused on this system have shown that *P. pluricintus* is able to disperse seeds across long distances [@holbrook_using_2007; @holbrook_dispersal_2009; @holbrook_home_2011], an important for plant population. Long distance dispersal (LDD) events are crucial to reaching suitable sites to germinate and establish and to colonize new habitats [@nathan2006long]. Furthermore, rare events (often overlooked) are critical for dispersal and might have a large effect on resulting plant demography [@loayza2014seed]. Our first objective in this work was to study the differences of simulated seed shadows between models with and without underlying variability in animal movement. The second objective focused on quantifying the differences of LDD events reflected between seed shadows. Lastly, our third objective focused on the spatial spread between seeds, and how individual variation in animal movement affects seed aggregation. Identifying the implications of individual variation in animal movement over seed dispersal estimates can help us improve future models and understand the effects of frugivore traits on plant population dynamics.


# Methods
## Simulation description

To study the effects of individual variation in animal movement over final dispersal distances of foraged seeds, we developed a spatially-explicit individual-based model in a homogenous landscape consisting of a single source tree. We incorporated animal movement focusing on two characteristics, a movement distance (MD) sampled from a probability density distribution, and a movement angle (MA). In addition to this, we included gut retention time (GRT), the time that ingested seeds stay within the frugivore until they are dropped. The animal was allowed to move freely within the landscape, and GRT determined when the animal would drop a seed. Once a seed was dropped, its location was recorded and seed dispersal distance was estimated as the distance from the origin to the seed's location. The average seed dispersal distance for each simulation run was calculated and used to estimate seed dispersion, calculated as the mean distance of each seed to the average location of all seeds in the run [@jones_closing_2017]. For each simulation run, the simulation started at the source tree, an animal received a specific number of seeds and each seed was assigned a specific GRT sampled from a gamma distribution [@morales_effects_2006]. The simulation was based on one minute time steps, where at each time step a movement distance (MD) and movement angle (MA) would determine the path for the animal to follow. For each seed, the location where it would get dropped was based on the animal's location at the time it reached the GRT for each of the seeds. The total simulation time for each run was determined by the largest GRT sampled for that specific simulation run. Each simulation run focused on one individual animal dispersing seeds from one focus tree. Once all seeds in that run were dropped by the animal, the simulation run ended.

## Study design

To understand the consequences of individual variation in animal movement and how these influence seed dispersal distances, we simulated three different scenarios by varying the movement of individual animals in each of those scenarios. We used our first scenario as our null model, in which all the individuals from the simulation had the same average movement rate ($\lambda_1 = \lambda_2 = ... = \lambda_n$), used as the parameter in the probability density function, and thus their movement distances per unit of time were sampled from the same probability distribution ($f(x;\lambda) = \lambda e^{-\lambda x}$). Our second scenario included individual variation in animal movement by incorporating different movement rates for each individual ($\lambda_1 = \lambda_2 = ... = \lambda_n$), which meant that movement distances would be sampled from probability distributions with different parameters ($f(x;\lambda_i) = \lambda_i e^{-\lambda_i x}$). Considering that not all individuals are independent of each other, and that by belonging to social groups their movement patterns might be correlated, our third scenario ran simulations at the scale of family group variation in animal movement by assigning a different movement rate to each social group in the simulations. 

<!-- Here I would like to have a figure that incorporates all these different simulation components as a self explanatory box for how a simulation run happens, and what data goes in, what data is calculated and comes out. -->

```{r eval = TRUE, fig.width=6}
set.seed(5)

data(ptpl)
# Panel 1: landscape with tree in the center, origin

df <- data.frame()
ggplot(df) + xlim(-100, 100) + ylim(-100, 100) + 
  theme(
  panel.background = element_rect(fill = "lightblue",
                                colour = "lightblue",
                                size = 0.5, linetype = "solid"),
  panel.grid.major = element_line(size = 0.5, linetype = 'solid',
                                colour = "white"), 
  panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
                                colour = "white")
  ) +
  coord_equal() +
  geom_point(aes(x = 0, y = 0), color = "green") -> p1

# Panel 2: Table with gut retention times and the gamma distribution used for it
n <- 10000
grt_dens <- data.frame(seq = 1:n, dat = (rgamma(n, shape = 4, scale = 5) + 8))
grt_data <- data.frame(time = round(sample(grt_dens$dat, 5)), seq = 1:5)
tt <- max(grt_data$time)
ggplot(grt_dens, aes(x = dat)) +
  geom_density() + 
  geom_point(data = grt_data, aes(x = time, y = 0)) +
  theme_bw() + labs(x = "Time in minutes") -> p2


# Panel 3: Exponential distribution used for animal movement lengths
rate <- 1/mean(ptpl$mpm)
md_dens <- data.frame(seq = 1:n, dat = rexp(n, rate = rate))
ggplot(md_dens, aes(x = dat)) +
  geom_density() + 
  theme_bw() + labs(x = "Length of movement in one minute") -> p3



# Panel 4: Animal trajectory and locations of the seeds at the time the seeds are dropped

distance <- sample(md_dens$dat, tt)
angle <- runif(tt, min = 0, max = 360)
distx <- distance*cos(angle)
xloc <- c(0, cumsum(distx))
disty <- distance*sin(angle)
yloc <- c(0, cumsum(disty))
animalTraj <- data.frame(time = 0:tt, xloc = xloc, yloc = yloc)
seed_loc <- merge(animalTraj, grt_data, by = "time")
mean_seed_loc <- data.frame(x = mean(seed_loc$xloc), y = mean(seed_loc$yloc))

ggplot() +
  geom_path(data = animalTraj, aes(x = xloc, y = yloc)) +
  geom_point(data = seed_loc, aes(x = xloc, y = yloc), color = "red") +
  geom_point(aes(x = 0, y = 0), color = "green") -> p4

# Panel 5: Calculation of seed dispersal distances to the focus tree

ggplot() +
  geom_point(data = seed_loc, aes(x = xloc, y = yloc), color = "red") +
  geom_point(aes(x = 0, y = 0), color = "green") +
  geom_segment(aes(x = seed_loc$xloc, xend = 0, y = seed_loc$yloc, yend = 0)) -> p5


# Panel 6: Calculation of seed dispersion

ggplot() +
  geom_point(data = seed_loc, aes(x = xloc, y = yloc), color = "red") +
  geom_point(data = mean_seed_loc, aes(x = x, y = y), color = "blue") +
  geom_segment(aes(x = seed_loc$xloc, xend = mean_seed_loc$x, y = seed_loc$yloc, yend = mean_seed_loc$y)) -> p6

# ALL
plot_grid(p1, p2, p3, p4, p5, p6, labels = LETTERS[1:6], label_size = 10, nrow = 3)

```


## Parameterization

We focused our study on the many-banded araçari (*Pterglossus pluricinctus*), a small toucan, and its role as a frugivore of the *Virola flexuosa* tree. Previous studies by Holbrook [-@holbrook_home_2011] collected radiotracking information for various dispersers over a period of four years, from 2001 to 2005, in the Ecuadorian Amazon rainforest. The methodology used at the time consisted of capturing and radio-tagging individuals from various toucan species, including *Pterglossus pluricinctus* and two larger Ramphastids, although data on these was scarce. Tracking periods lasted between four and six daylight hours, alternating morning and afternoons, attempting to record bird locations every 15 minutes, a time interval shown to represent the minimum seed retention time for *Virola flexuosa* seeds [@holbrook_using_2007]. Out of the data collected, and following Holbrook [-@holbrook_home_2011], we selected bird individuals with at least 40 recorded point locations. Even though location recordings were attempted every 15 minutes, this was not always possible, due to the individual being too far out from range or canopy cover, therefore point locations data is available every 15 minutes or multiples of 15 minutes, with the majority of point location recordings between 15 and 30 minutes [@holbrook_home_2011]. Further details on field methods can be found in Holbrook [-@holbrook_home_2011].  

To take advantage of all the locations recorded for series of successive points, despite this variation in duration of time intervals, we calculated rates of movement, as the average number of meters moved per minute over the entire tracking period for that individual bird. These movement rates were later used in our simulation models as the parameter to describe the probability distribution of movement distances at each one minute time step for each simulation run. In the case of our null model, the movement rate was averaged across all individuals for all the tracking periods, and at the social group level we took the average number of meters moved per minute over the tracking periods for all individuals belonging to that group, with a total of 7 independent groups.   

Parameter values for gut retention time were also based on empirically collected data from previous studies [@holbrook_using_2007], were  passage trials were carried out with *Pteroglossus pluricinctus* individuals. However, these passage trials were not performed on every individual captured and some of the trials were also performed with captive birds, thus we could not explore individual variation in gut retention times for the individuals in the movement data set. These trials showed that the average gut retention time for *Pterglossus pluricinctus* was 28 minutes [@holbrook_using_2007], and maximum retention times over 100 minutes. The distribution of gut retention times is characteristically fat-tailed, thus we used a gamma distribution (shape = 4, scale = 5) with the appropriate shift to match our average retention time of 28 minutes [@morales_effects_2006; @levey_effects_2005], and used this distribution to sample gut retention times for each of our simulation runs.

*Include table in the supplement with the movement rates*


## Model processes

Each simulation run in our models consisted of one animal in a homogeneous landscape starting at the focus tree located at coordinates (0,0). We assume the landscape is in meters, as the sampling of movement distances for animal movement comes from estimates of meters moved per minute, the movement rates.  Informed from field observations, *Pteroglossus pluricinctus* have a mean visit length of 4.0 minutes for each fruiting tree, consuming between 2 and 5 seeds during each visit, and not visiting another fruiting tree immediately after feeding (Holbrook's dissertation and personal communication [@holbrook2007seed]). Due to this underlying behavior, we decided to focus our simulations specifically to the events associated to feeding from one focus tree, and the animal movement occurring after foraging and before visiting another fruiting tree. Since one of the objectives for this paper is to explore the occurrence of long-distance dispersal events, we did not set boundaries for the landscape. *Pteroglossus pluricinctus* has shown maximum travel distances exceeding 3500m in a single 30 minute tracking interval, thus showing the potential to disperse *Virola* seeds at long ranges [@holbrook_home_2011]. 

At the beginning of each simulation run, the animal consumed five seeds at the focus tree location, and each of these seeds was assigned a gut retention time sampled from a gamma distribution (shape=4, scale=5, shift=8). Once the animal in the simulation consumed the seeds, a movement distance was sampled from the assigned exponential distribution (which varied depending on the underlying model such as the null, individual or family group model) and a random direction from $0^o$ to $360^o$ degrees was used to determine the animal's position for the next time step, repeating this process for every time step and thus following an uncorrelated random walk with no directional tendency. Once the simulation run's time matched the gut retention time for a seed, that seed would get dropped at the animal's location at that specific time point, thus allowing us to record seed location in the landscape. For each of our models we ran 10,000 simulation runs per individual or family group, depending on the model, and collected information on animal and seed locations at every time step.

## Seed dispersal and aggregation metrics

We calculated seed dispersal distance as the euclidean distance of each seed to the parent plant. Given that our models only considered one parent plant located at the origin per simmulation, we calculated seed dispersal distance (DD) as the distance from each seed's location to the origin as follows:
$$DD_i = \sqrt{(0-x_i)^2 + (0-y_i)^2} $$
where $DD_i$ is the dispersal distance for seed $i$ in the simulation run and $x_i$ and $y_i$ are its xy coordinates in the landscape. We also used an aggregation metric to determine how evenly seeds would be dispersed across the landscape, and calculated seed dispersion (SD) as the average distance of each seed to the mean seed location in each simulation run (following methods in [@jones_closing_2017]):
$$SD = \frac{\sum \sqrt{(x_m - x_i)^2 + (y_m - y_i)^2}}{n}$$
where $n$ is the number of seeds for each simulation run (5), and $x_m$ and $y_m$ is the mean seed location in the simulation run. The information on seed dispersal distance was used for the toucan-generated seed dispersal kernels for each one of our models (null, individual, and family group), and these seed dispersal distances were also classified as long distance dispersal events if they exceeded 500m [@holbrook_using_2007]. The proportion of long-distance dispersal events, maximum dispersal distance, and average seed dispersion were used to compare seed dispersal between our three models of individual variation (Table1).


## Seed dispersal kernels

- Already fit the weibull distribution for this. Mention that we chose this distribution because it is commonly used in dispersal ecology due to its felixibility, how adjusting the scale parameter changes the tail of the distribution. This is both in Garcia2017 (>1 fast decaying, <1 low decay fat tail, =1 exponential decay) and Carlomorales2006 papers, but I think they present it slightly different. 

- We inspected the QQ plots to check for fitting. Figuere Supplement

- They mention declustering the data, and perhaps in that case I could be using the mean_xy_dispersal.


# Results

```{r}
load("dispersal_kernels.RData")
```
## Seed dispersal distances and long distance dispersal 

**Figure 3.**
```{r fig.width=6}

null_kernel <- null_dispersal %>% 
  ggplot(., aes(x = dispersal)) +
  geom_histogram(aes(y = ..density..))

indiv_kernel <- indiv_dispersal %>% 
  ggplot(., aes(x = dispersal)) +
  geom_histogram(aes(y = ..density..))

fam_kernel <- fam_dispersal %>% 
  ggplot(., aes(x = dispersal)) +
  geom_histogram(aes(y = ..density..))

plot_grid(null_kernel, indiv_kernel, fam_kernel, nrow = 3)

# Make the axis be the same length and beaks
# Remove redundant labels
# Test 3 rows or 3 columns
# Add red vertical line for LDD cutoff
# Include a zoom cut off for the tail


# plot_grid(
#   fam_dispersal %>%
#     ggplot(., aes(x = dispersal)) +
#     geom_histogram(),
#   plot_grid(fam_dispersion %>%
#             ggplot(., aes(y = mean_dispersal)) +
#             geom_boxplot(),
#           fam_dispersion %>%
#             ggplot(., aes(y = seed_dispersion)) +
#             geom_boxplot()), nrow = 2)
```


## Seed dispersion aggregation
The mean dispersal in the boxplots is not the same as the dispersal distances before. This mean dispersal is the distance from the origin to the mean seed location in each simulation run. The mean seed location is used to calculate dispersion, as the average distance of each seed to the mean seed location, as shown in Figure 1.

**Figure 4.**
```{r fig.width=3, fig.height=5}

null_dispersion %>% 
  mutate(model = "Null") %>% 
  bind_rows(indiv_dispersion %>% 
              mutate(model = "Individual")) %>% 
  bind_rows(fam_dispersion %>% 
              mutate(model = "Family")) %>% 
  mutate(model = factor(model, levels = c("Null", "Individual", "Family"))) -> all_disp_data

  
all_disp_data %>% 
  ggplot(., aes(y = mean_xy_dispersal, x = model)) +
  geom_boxplot() -> dispersal_xy_box

all_disp_data %>% 
  ggplot(., aes(y = mean_dispersal, x = model)) +
  geom_boxplot() -> dispersal_box


all_disp_data %>% 
  ggplot(., aes(y = seed_dispersion, x = model)) +
  geom_boxplot() -> dispersion_box

plot_grid(dispersal_xy_box, dispersal_box, dispersion_box, nrow = 3)

# Edit redundant labels
# Fix names for axes

```


## Weibull seed dispersal kernel 

**Table 1.**
```{r}

knitr::kable(dispersal_kernel_table)
```

## Extreme distributions to fit dispersal

Explain what are statistics of extremes and why they can be useful here. cite the GArcia 2017 paper, the Gaines and Denny 1993, Katz 2005. Coles 2001 for the theory or base knowledge. In our case, because we are looking at these simulated seed dispersal kernels, we use a peak over threshold (POT) approach, in which we find the threshold for the data and use an extreme value distribution to fit the tail. 
Describe the math probabilty density functions and the three laws that the extreme value distribution follows. 
For POT use a generalized pareto distribution. 

- Based on Diagnostic plots, we used these values as the threshold for each of the models.

From extRemes package: "where shape = 0 gives rise to the exponential df (light tail), shape > 0 the Pareto df (heavy tail) and shape < 0 the Beta df (bounded upper tail at location - scale.u/shape). Theoretical justification supports the use of the GP df family for modeling excesses over a high threshold (i.e., y = x - threshold)."


# Discussion

Even though LDD events are rare or infrequent, they have a disproportionately large effect on gene flow and the genetic pool of populations (Jordano 2017). In the case of well mixed populations, long-distance dispersal can cause random genetic loss through drift or have the opposite effect and maintain high genetic variance in populations that initially drifted (Bohrer, Nathan, and Volis 2005). This is important as in the long-term, these genetic consequences of dispersal can have significant effects for the survival of populations. From a metapopulation perspective, LDD events can have significant consequences for species persistence by enhancing genetic variability and as mechanism for survival in spatially and temporally heterogenous environments. In particular, long-distance dispersal events have a higher probability of reaching isolated populations and therefore establishing a connection and maintaining unrelated populations. It is of special interest to focus in highly heterogenous habitats with rapid change in spatial structure where local extinctions are high, since long-distance dispersal can allow persistence of a metapopulation with immigration and emigration based on long distance dispersal. From a more evolutionary perspective, long-distance dispersal can allow for a species to colonize distant habitats and expand its range, which can also lead to differentiation and speciation (Ronce 2007). We have shown that individual differences in frugivore movement can have significant consequences on the number of long-distance seed dispersal events and it remains to be explored how these individual differences can influence population dynamics in the long term and at larger spatial scales.


# Conclusion

# Acknowledgements



# References

